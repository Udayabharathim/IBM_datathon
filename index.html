{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "12a29f68-1040-4d4e-a518-60d3d162863b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Defaulting to user installation because normal site-packages is not writeable\n",
      "Requirement already satisfied: tabulate in /home/jovyan/.local/lib/python3.10/site-packages (0.9.0)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install tabulate"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "5e53965b-7fbe-4c27-acb9-17a077a13d6b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "['recipes.csv - Sheet1.csv', 'Untitled.ipynb', 'exercise.csv - sheet1.csv', 'AVAL.ipynb', '.ipynb_checkpoints', 'CLEAN- PCOS SURVEY SPREADSHEET.csv']\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "print(os.listdir(os.getcwd()))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "69b97e6b-bafb-4c56-aeb7-58f83466e6f9",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model Accuracy: 0.9354838709677419\n",
      "              precision    recall  f1-score   support\n",
      "\n",
      "         0.0       0.95      0.97      0.96        80\n",
      "         1.0       0.82      0.69      0.75        13\n",
      "\n",
      "    accuracy                           0.94        93\n",
      "   macro avg       0.88      0.83      0.86        93\n",
      "weighted avg       0.93      0.94      0.93        93\n",
      "\n",
      "Welcome to the PCOS detection chatbot!\n",
      "\n",
      "You can enter your request (e.g., 'predict PCOS', 'get diet and exercise recommendations', or 'quit').\n"
     ]
    },
    {
     "name": "stdin",
     "output_type": "stream",
     "text": [
      "\n",
      "What would you like to do?  quit\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Thank you for using the PCOS chatbot. Goodbye!\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import random\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.impute import SimpleImputer\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.metrics import accuracy_score, classification_report\n",
    "from tabulate import tabulate\n",
    "\n",
    "# Load the datasets\n",
    "data_path = 'CLEAN- PCOS SURVEY SPREADSHEET.csv'\n",
    "df = pd.read_csv(data_path)\n",
    "\n",
    "recipes_path = 'recipes.csv - Sheet1.csv'\n",
    "recipes_df = pd.read_csv(recipes_path, encoding='latin-1')\n",
    "\n",
    "exercise_path = 'exercise.csv - sheet1.csv'\n",
    "exercise_df = pd.read_csv(exercise_path, encoding='latin-1')\n",
    "\n",
    "# Fill missing values\n",
    "imputer = SimpleImputer(strategy='mean')\n",
    "df_imputed = pd.DataFrame(imputer.fit_transform(df), columns=df.columns)\n",
    "\n",
    "# Define target column and features\n",
    "target_column = 'Have you been diagnosed with PCOS/PCOD?'  # Adjust this as needed\n",
    "X = df_imputed.drop(columns=[target_column])\n",
    "y = df_imputed[target_column]\n",
    "\n",
    "# Train-test split\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n",
    "scaler = StandardScaler()\n",
    "X_train_scaled = scaler.fit_transform(X_train)\n",
    "X_test_scaled = scaler.transform(X_test)\n",
    "\n",
    "# Train the model\n",
    "model = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "model.fit(X_train_scaled, y_train)\n",
    "y_pred = model.predict(X_test_scaled)\n",
    "\n",
    "# Evaluate the model\n",
    "accuracy = accuracy_score(y_test, y_pred)\n",
    "print(f\"Model Accuracy: {accuracy}\")\n",
    "print(classification_report(y_test, y_pred))\n",
    "\n",
    "def generate_diet_and_exercise_plan():\n",
    "    days = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]\n",
    "    meals = [\"Breakfast\", \"Lunch\", \"Dinner\"]\n",
    "\n",
    "    diet_table_data = [[\"Days\", \"Breakfast\", \"Lunch\", \"Dinner\"]]\n",
    "    exercise_table_data = [[\"Days\", \"Morning Exercise\", \"Evening Exercise\"]]\n",
    "\n",
    "    recipe_name_column = recipes_df.columns[0]\n",
    "    exercise_name_column = exercise_df.columns[0]\n",
    "\n",
    "    for day in days:\n",
    "        diet_row = [day]\n",
    "        for meal in meals:\n",
    "            recipe = recipes_df.sample(1)\n",
    "            diet_row.append(recipe[recipe_name_column].values[0])\n",
    "        diet_table_data.append(diet_row)\n",
    "\n",
    "        exercise_row = [day]\n",
    "        morning_exercise = exercise_df.sample(1)\n",
    "        evening_exercise = exercise_df.sample(1)\n",
    "        exercise_row.extend([morning_exercise[exercise_name_column].values[0], evening_exercise[exercise_name_column].values[0]])\n",
    "        exercise_table_data.append(exercise_row)\n",
    "\n",
    "    print(\"\\n--- Personalized Weekly Diet Plan ---\")\n",
    "    print(tabulate(diet_table_data, headers=\"firstrow\", tablefmt=\"grid\"))\n",
    "    print(\"\\n--- Personalized Weekly Exercise Plan ---\")\n",
    "    print(tabulate(exercise_table_data, headers=\"firstrow\", tablefmt=\"grid\"))\n",
    "    print(\"\\nPlease follow the meal and exercise plans to manage PCOS effectively.\")\n",
    "\n",
    "def pcos_chatbot():\n",
    "    print(\"Welcome to the PCOS detection chatbot!\")\n",
    "    \n",
    "    while True:\n",
    "        print(\"\\nYou can enter your request (e.g., 'predict PCOS', 'get diet and exercise recommendations', or 'quit').\")\n",
    "        \n",
    "        user_input = input(\"\\nWhat would you like to do? \").strip().lower()\n",
    "\n",
    "        # Check for PCOS prediction keywords\n",
    "        if \"predict\" in user_input or \"diagnosis\" in user_input:\n",
    "            print(\"\\nPlease answer the following questions for PCOS prediction:\")\n",
    "            user_data = []\n",
    "            blood_group_mapping = {\n",
    "                'A+': 11, 'A-': 12,\n",
    "                'B+': 13, 'B-': 14,\n",
    "                'O+': 15, 'O-': 16,\n",
    "                'AB+': 17, 'AB-': 18\n",
    "            }\n",
    "\n",
    "            for feature in X.columns:\n",
    "                if 'blood group' in feature.lower():\n",
    "                    while True:\n",
    "                        blood_group = input(\"Enter your blood group (e.g., A+, O-): \").upper()\n",
    "                        if blood_group in blood_group_mapping:\n",
    "                            value = blood_group_mapping[blood_group]\n",
    "                            break\n",
    "                        else:\n",
    "                            print(\"Invalid blood group entered. Please try again.\")\n",
    "                else:\n",
    "                    while True:\n",
    "                        try:\n",
    "                            value = float(input(f\"Enter value for {feature} (numeric input expected): \"))\n",
    "                            break\n",
    "                        except ValueError:\n",
    "                            print(\"Invalid input. Please enter a numeric value.\")\n",
    "                user_data.append(value)\n",
    "\n",
    "            # Make prediction\n",
    "            user_data_scaled = scaler.transform([user_data])\n",
    "            prediction = model.predict(user_data_scaled)\n",
    "\n",
    "            if prediction == 1:\n",
    "                print(\"\\nThe chatbot predicts that you might have PCOS.\")\n",
    "            else:\n",
    "                print(\"\\nThe chatbot predicts that you likely do not have PCOS. However, consult a doctor if you have concerns.\")\n",
    "\n",
    "        # Check for recommendation keywords\n",
    "        elif \"recommendation\" in user_input or \"recommend\" in user_input:\n",
    "            print(\"\\nLet's collect more information for a personalized lifestyle plan.\")\n",
    "            busy_morning = input(\"Do you usually have a busy morning schedule? (yes/no): \").strip().lower()\n",
    "            work_hours = int(input(\"On average, how many hours do you spend at work or school each day? (0-12): \").strip())\n",
    "            exercise_freq = input(\"How often do you exercise each week? (never/1-2 times/3-5 times/daily): \").strip().lower()\n",
    "            preferred_exercise_type = input(\"Do you prefer high-intensity or low-intensity exercises? (high/low): \").strip().lower()\n",
    "            time_of_day_exercise = input(\"When do you prefer to exercise? (morning/evening/both): \").strip().lower()\n",
    "            exercise_duration = int(input(\"How much time can you dedicate to each exercise session? (in minutes): \").strip())\n",
    "\n",
    "            generate_diet_and_exercise_plan()\n",
    "\n",
    "        # Exit the chatbot\n",
    "        elif \"quit\" in user_input:\n",
    "            print(\"\\nThank you for using the PCOS chatbot. Goodbye!\")\n",
    "            break\n",
    "\n",
    "        else:\n",
    "            print(\"\\nInvalid input. Please enter a valid command (e.g., 'predict PCOS', 'get diet and exercise recommendations', or 'quit').\")\n",
    "\n",
    "# Run the chatbot\n",
    "pcos_chatbot()\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "2b436755-e5fa-4357-96d9-923cd8c5bac1",
   "metadata": {},
   "outputs": [
    {
     "ename": "ModuleNotFoundError",
     "evalue": "No module named 'tkinter'",
     "output_type": "error",
     "traceback": [
      "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m",
      "\u001b[0;31mModuleNotFoundError\u001b[0m                       Traceback (most recent call last)",
      "Cell \u001b[0;32mIn[5], line 3\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mpandas\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mpd\u001b[39;00m\n\u001b[1;32m      2\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mrandom\u001b[39;00m\n\u001b[0;32m----> 3\u001b[0m \u001b[38;5;28;01mimport\u001b[39;00m \u001b[38;5;21;01mtkinter\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m \u001b[38;5;21;01mtk\u001b[39;00m\n\u001b[1;32m      4\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01mtkinter\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m messagebox\n\u001b[1;32m      5\u001b[0m \u001b[38;5;28;01mfrom\u001b[39;00m \u001b[38;5;21;01msklearn\u001b[39;00m\u001b[38;5;21;01m.\u001b[39;00m\u001b[38;5;21;01mmodel_selection\u001b[39;00m \u001b[38;5;28;01mimport\u001b[39;00m train_test_split\n",
      "\u001b[0;31mModuleNotFoundError\u001b[0m: No module named 'tkinter'"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import random\n",
    "import tkinter as tk\n",
    "from tkinter import messagebox\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from sklearn.impute import SimpleImputer\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.metrics import accuracy_score, classification_report\n",
    "from tabulate import tabulate\n",
    "\n",
    "# Load the datasets\n",
    "data_path = 'CLEAN- PCOS SURVEY SPREADSHEET.csv'\n",
    "df = pd.read_csv(data_path)\n",
    "\n",
    "recipes_path = 'recipes.csv - Sheet1.csv'\n",
    "recipes_df = pd.read_csv(recipes_path, encoding='latin-1')\n",
    "\n",
    "exercise_path = 'exercise.csv - sheet1.csv'\n",
    "exercise_df = pd.read_csv(exercise_path, encoding='latin-1')\n",
    "\n",
    "# Fill missing values\n",
    "imputer = SimpleImputer(strategy='mean')\n",
    "df_imputed = pd.DataFrame(imputer.fit_transform(df), columns=df.columns)\n",
    "\n",
    "# Define target column and features\n",
    "target_column = 'Have you been diagnosed with PCOS/PCOD?'  # Adjust this as needed\n",
    "X = df_imputed.drop(columns=[target_column])\n",
    "y = df_imputed[target_column]\n",
    "\n",
    "# Train-test split\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n",
    "scaler = StandardScaler()\n",
    "X_train_scaled = scaler.fit_transform(X_train)\n",
    "X_test_scaled = scaler.transform(X_test)\n",
    "\n",
    "# Train the model\n",
    "model = RandomForestClassifier(n_estimators=100, random_state=42)\n",
    "model.fit(X_train_scaled, y_train)\n",
    "\n",
    "# Function to make PCOS prediction\n",
    "def predict_pcos(user_data):\n",
    "    user_data_scaled = scaler.transform([user_data])\n",
    "    prediction = model.predict(user_data_scaled)\n",
    "    if prediction == 1:\n",
    "        return \"The chatbot predicts that you might have PCOS.\"\n",
    "    else:\n",
    "        return \"The chatbot predicts that you likely do not have PCOS. However, consult a doctor if you have concerns.\"\n",
    "\n",
    "# Function to generate diet and exercise plan\n",
    "def generate_diet_and_exercise_plan():\n",
    "    days = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"]\n",
    "    meals = [\"Breakfast\", \"Lunch\", \"Dinner\"]\n",
    "\n",
    "    diet_table_data = [[\"Days\", \"Breakfast\", \"Lunch\", \"Dinner\"]]\n",
    "    exercise_table_data = [[\"Days\", \"Morning Exercise\", \"Evening Exercise\"]]\n",
    "\n",
    "    recipe_name_column = recipes_df.columns[0]\n",
    "    exercise_name_column = exercise_df.columns[0]\n",
    "\n",
    "    for day in days:\n",
    "        diet_row = [day]\n",
    "        for meal in meals:\n",
    "            recipe = recipes_df.sample(1)\n",
    "            diet_row.append(recipe[recipe_name_column].values[0])\n",
    "        diet_table_data.append(diet_row)\n",
    "\n",
    "        exercise_row = [day]\n",
    "        morning_exercise = exercise_df.sample(1)\n",
    "        evening_exercise = exercise_df.sample(1)\n",
    "        exercise_row.extend([morning_exercise[exercise_name_column].values[0], evening_exercise[exercise_name_column].values[0]])\n",
    "        exercise_table_data.append(exercise_row)\n",
    "\n",
    "    # Convert tables to strings for display in UI\n",
    "    diet_plan = tabulate(diet_table_data, headers=\"firstrow\", tablefmt=\"grid\")\n",
    "    exercise_plan = tabulate(exercise_table_data, headers=\"firstrow\", tablefmt=\"grid\")\n",
    "    return diet_plan, exercise_plan\n",
    "\n",
    "# Tkinter setup\n",
    "def run_chatbot():\n",
    "    def on_submit():\n",
    "        request = user_input.get()\n",
    "        if \"predict\" in request.lower():\n",
    "            # Simulate user data for prediction (can be extended to take actual input fields)\n",
    "            user_data = [random.uniform(10, 100) for _ in range(X.shape[1])]\n",
    "            result = predict_pcos(user_data)\n",
    "            result_label.config(text=result)\n",
    "        \n",
    "        elif \"recommend\" in request.lower():\n",
    "            diet_plan, exercise_plan = generate_diet_and_exercise_plan()\n",
    "            messagebox.showinfo(\"Diet and Exercise Plan\", f\"Diet Plan:\\n{diet_plan}\\n\\nExercise Plan:\\n{exercise_plan}\")\n",
    "        \n",
    "        elif \"quit\" in request.lower():\n",
    "            window.quit()\n",
    "        else:\n",
    "            result_label.config(text=\"Invalid command. Try 'predict', 'recommend', or 'quit'.\")\n",
    "\n",
    "    # Main window\n",
    "    window = tk.Tk()\n",
    "    window.title(\"PCOS Chatbot\")\n",
    "\n",
    "    # User input and labels\n",
    "    instruction_label = tk.Label(window, text=\"Enter your request (predict, recommend, or quit):\")\n",
    "    instruction_label.pack()\n",
    "\n",
    "    user_input = tk.Entry(window)\n",
    "    user_input.pack()\n",
    "\n",
    "    submit_button = tk.Button(window, text=\"Submit\", command=on_submit)\n",
    "    submit_button.pack()\n",
    "\n",
    "    result_label = tk.Label(window, text=\"\")\n",
    "    result_label.pack()\n",
    "\n",
    "    window.mainloop()\n",
    "\n",
    "# Run the Tkinter chatbot\n",
    "run_chatbot()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "340ad882-6eeb-4c75-bcd0-f456f04698ff",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
